<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>AI-HydroSpace –°—ã—Ä–¥–∞—Ä–∏—è / –ö—ã–∑—ã–ª–æ—Ä–¥–∞</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{margin:0;font-family:Arial;background:#eef6f9}
header{background:#0077b6;color:#fff;padding:20px;text-align:center}
main{max-width:1300px;margin:20px auto;padding:15px}
.card{background:#fff;border-radius:12px;padding:20px;margin-bottom:20px;box-shadow:0 2px 8px rgba(0,0,0,.1)}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:15px}
#map{height:500px;border-radius:10px}
.status{padding:6px 12px;border-radius:6px;color:#fff;display:inline-block}
.normal{background:#2ecc71}
.warning{background:#f39c12}
high{background:#e74c3c;color:#fff;padding:6px 10px;border-radius:6px}
select,button{padding:10px;font-size:16px;border-radius:8px;border:none}
button{background:#00b4d8;color:#fff;width:100%;cursor:pointer}
button:hover{background:#0096c7}
canvas{max-height:300px}
</style>
</head>

<body>

<header>
<h1>üåä AI-HydroSpace –°—ã—Ä–¥–∞—Ä–∏—è / –ö—ã–∑—ã–ª–æ—Ä–¥–∞</h1>
<p id="subtitle"></p>
<select id="lang" onchange="setLang()">
<option value="ru">–†—É—Å—Å–∫–∏–π</option>
<option value="kz">“ö–∞–∑–∞“õ—à–∞</option>
<option value="en">English</option>
</select>
</header>

<main>

<div class="grid">
<div class="card">
<h3 id="lvlTitle"></h3>
<div id="waterLevel" style="font-size:38px;font-weight:bold">--</div>
<div id="status" class="status normal"></div>
</div>

<div class="card">
<h3 id="ratingTitle"></h3>
<ul id="ratingList"></ul>
</div>
</div>

<div class="card">
<h3 id="mapTitle"></h3>
<div id="map"></div>
</div>

<div class="grid">
<div class="card">
<h3 id="chart1Title"></h3>
<canvas id="depthChart"></canvas>
</div>

<div class="card">
<h3 id="chart2Title"></h3>
<canvas id="volumeChart"></canvas>
</div>

<div class="card">
<h3 id="chart3Title"></h3>
<canvas id="qualityChart"></canvas>
</div>
</div>

<div class="card">
<h3 id="aiTitle"></h3>
<p id="aiTip"></p>
</div>

<button onclick="updateData()" id="btn"></button>

</main>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
/* -------- –Ø–ó–´–ö–ò -------- */
const T={
ru:{
sub:"–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –°—ã—Ä–¥–∞—Ä–∏–∏ –∏ –≤–æ–¥–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤",
lvl:"–°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å –≤–æ–¥—ã",
map:"–°–ø—É—Ç–Ω–∏–∫–æ–≤–∞—è –∫–∞—Ä—Ç–∞ –∏ –ø—Ä–æ–±–ª–µ–º—ã",
rating:"–†–µ–π—Ç–∏–Ω–≥ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –∑–æ–Ω",
c1:"–ì–ª—É–±–∏–Ω–∞ (–º)",
c2:"–û–±—ä—ë–º (–º¬≥)",
c3:"–ß–∏—Å—Ç–æ—Ç–∞ (%)",
ai:"AI-–∞–Ω–∞–ª–∏–∑",
btn:"üîÑ –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ",
norm:"–ù–æ—Ä–º–∞",
risk:"–í–Ω–∏–º–∞–Ω–∏–µ: —Ä–∏—Å–∫",
high:"–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —É—Ä–æ–≤–µ–Ω—å",
aiGood:"–í —Ü–µ–ª–æ–º —Ä–µ—Å—É—Ä—Å—ã –≤ –Ω–æ—Ä–º–µ.",
aiBad:"–ï—Å—Ç—å –∑–æ–Ω—ã –≤—ã—Å–æ–∫–æ–≥–æ —Ä–∏—Å–∫–∞.",
},
kz:{
sub:"–°—ã—Ä–¥–∞—Ä–∏—è –º–µ–Ω —Å—É —Ä–µ—Å—É—Ä—Å—Ç–∞—Ä—ã–Ω –±–∞“õ—ã–ª–∞—É",
lvl:"–û—Ä—Ç–∞—à–∞ —Å—É –¥–µ“£–≥–µ–π—ñ",
map:"–°–ø—É—Ç–Ω–∏–∫—Ç—ñ–∫ –∫–∞—Ä—Ç–∞ –∂”ô–Ω–µ –º”ô—Å–µ–ª–µ–ª–µ—Ä",
rating:"–ú”ô—Å–µ–ª–µ–ª—ñ –∞–π–º–∞“õ—Ç–∞—Ä —Ä–µ–π—Ç–∏–Ω–≥—ñ",
c1:"–¢–µ—Ä–µ“£–¥—ñ–≥—ñ (–º)",
c2:"–°—É –∫”©–ª–µ–º—ñ (–º¬≥)",
c3:"–°—É–¥—ã“£ —Ç–∞–∑–∞–ª—ã“ì—ã (%)",
ai:"AI —Ç–∞–ª–¥–∞—É",
btn:"üîÑ –ñ–∞“£–∞—Ä—Ç—É",
norm:"“ö–∞–ª—ã–ø—Ç—ã",
risk:"“ö–∞—É—ñ–ø –±–∞—Ä",
high:"–°—ã–Ω–∞–ª–∞—Ç—ã–Ω –¥–µ“£–≥–µ–π",
aiGood:"–ñ–∞–ª–ø—ã –∂–∞“ì–¥–∞–π “õ–∞–ª—ã–ø—Ç—ã.",
aiBad:"–ñ–æ“ì–∞—Ä—ã “õ–∞—É—ñ–ø –∞–π–º–∞“õ—Ç–∞—Ä—ã –±–∞—Ä.",
},
en:{
sub:"Syr Darya & Water Resource Monitoring",
lvl:"Average water level",
map:"Satellite map & problem zones",
rating:"Problem zones rating",
c1:"Depth (m)",
c2:"Volume (m¬≥)",
c3:"Quality (%)",
ai:"AI Analysis",
btn:"üîÑ Update data",
norm:"Normal",
risk:"Warning: risk",
high:"Critical level",
aiGood:"Overall resources are stable.",
aiBad:"High-risk zones detected.",
}
};

let lang="ru";
function setLang(){
lang=document.getElementById("lang").value;
subtitle.textContent=T[lang].sub;
lvlTitle.textContent=T[lang].lvl;
mapTitle.textContent=T[lang].map;
ratingTitle.textContent=T[lang].rating;
chart1Title.textContent=T[lang].c1;
chart2Title.textContent=T[lang].c2;
chart3Title.textContent=T[lang].c3;
aiTitle.textContent=T[lang].ai;
btn.textContent=T[lang].btn;
updateData();
}

/* -------- –ö–∞—Ä—Ç–∞ -------- */
const osm=L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png");
const sat=L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}");
const map=L.map("map",{center:[44.9,65.4],zoom:9,layers:[osm]});
L.control.layers({"Map":osm,"Satellite":sat}).addTo(map);
let layers=[];

/* -------- –î–∏–∞–≥—Ä–∞–º–º—ã -------- */
let dChart,vChart,qChart;

/* -------- –î–∞–Ω–Ω—ã–µ -------- */
function updateData(){
layers.forEach(l=>map.removeLayer(l));
layers=[];

const water=(2+Math.random()*2).toFixed(2);
waterLevel.textContent=water+" m";
status.textContent=water<2.3?T[lang].high:water<2.5?T[lang].risk:T[lang].norm;

const zones=[
{lat:44.99,lng:65.22,name:"–°—ã—Ä–¥–∞—Ä–∏—è –†—É—Å–ª–æ",depth:1.7,clean:55,area:200},
{lat:44.78,lng:65.35,name:"–Æ–∂–Ω—ã–π –ö–∞–Ω–∞–ª",depth:2.1,clean:72,area:150},
{lat:44.85,lng:65.65,name:"–ü–æ–ª–µ –í–æ—Å—Ç–æ–∫",depth:2.6,clean:83,area:90},
{lat:44.92,lng:65.42,name:"–ö–∞–Ω–∞–ª –°–µ–≤–µ—Ä",depth:3.2,clean:90,area:210}
];

// —Ä–µ–π—Ç–∏–Ω–≥
zones.forEach(z=>z.score=
  Math.round((3-z.depth/2)*30 + (100-z.clean)*.4 + (5000/(z.area+1)))
);

zones.sort((a,b)=>b.score-a.score);

ratingList.innerHTML="";
zones.forEach(z=>ratingList.innerHTML+=`
<li><b>${z.name}</b> ‚Äî ${z.score} pts</li>
`);

let labels=[],depths=[],volumes=[],quality=[];

zones.forEach(z=>{
labels.push(z.name);
depths.push(z.depth);
quality.push(z.clean);
volumes.push(Math.round(z.area*z.depth*500));

let color=z.score>70?"red":z.score>50?"orange":"green";

const popup=`
<b>${z.name}</b><br>
üìè ${z.depth} m depth<br>
üíß ${Math.round(z.area*z.depth*500)} m¬≥ volume<br>
üß™ ${z.clean}% quality<br>
‚ö†Ô∏è Score: ${z.score}
`;

layers.push(
L.circle([z.lat,z.lng],{
radius:1400,color,fillColor:color,fillOpacity:.4
}).addTo(map).bindPopup(popup)
);
});

/* –¥–∏–∞–≥—Ä–∞–º–º—ã */
[dChart,vChart,qChart].forEach(c=>c&&c.destroy());

dChart=new Chart(depthChart,{type:"bar",data:{labels,datasets:[{data:depths}]}});

vChart=new Chart(volumeChart,{type:"line",data:{labels,datasets:[{data:volumes}]}});
 
qChart=new Chart(qualityChart,{type:"doughnut",data:{labels,datasets:[{data:quality}]}});

aiTip.textContent=zones[0].score>60?T[lang].aiBad:T[lang].aiGood;
}

setLang();
</script>

</body>
</html>
